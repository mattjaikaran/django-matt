# Django Matt CLI Tools

Django Matt provides several command-line tools to help you manage your Django projects. These tools are implemented as Django management commands and can be run using the `manage.py` script.

## Configuration Management

The `config` command provides utilities for managing Django Matt configuration files. It can help you initialize configuration files for your project, generate settings files for different environments, and create environment variable files.

### Subcommands

#### `init`

Initializes configuration files for your project. This includes:

- Creating a `config` directory in your project
- Creating an `__init__.py` file in the `config` directory
- Creating a `settings.py` file in your project
- Creating `.env` files for different environments

```bash
python manage.py config init [--force] [--env {development,staging,production,all}]
```

Options:
- `--force`: Overwrite existing files
- `--env`: Environment to initialize (default: all)

Example:
```bash
# Initialize configuration files for all environments
python manage.py config init

# Initialize configuration files for production only
python manage.py config init --env production

# Force overwrite of existing files
python manage.py config init --force
```

#### `generate`

Generates a `settings.py` file for a specific environment.

```bash
python manage.py config generate [--env {development,staging,production}] [--components COMPONENTS [COMPONENTS ...]] [--output OUTPUT]
```

Options:
- `--env`: Environment to generate settings for (default: development)
- `--components`: Components to include in the settings (default: database cache security performance)
- `--output`: Output file path (default: settings.py)

Example:
```bash
# Generate a settings.py file for development
python manage.py config generate

# Generate a settings.py file for production with specific components
python manage.py config generate --env production --components database cache security

# Generate a settings.py file with a custom output path
python manage.py config generate --output myproject/settings/development.py
```

#### `env`

Generates a `.env` file for a specific environment.

```bash
python manage.py config env [--env {development,staging,production}] [--output OUTPUT]
```

Options:
- `--env`: Environment to generate .env file for (default: development)
- `--output`: Output file path (default: .env)

Example:
```bash
# Generate a .env file for development
python manage.py config env

# Generate a .env file for production
python manage.py config env --env production

# Generate a .env file with a custom output path
python manage.py config env --output .env.local
```

### Generated Files

#### Settings File

The generated `settings.py` file uses the Django Matt configuration system to load settings from different environments and components. It includes:

- Environment detection
- Component loading
- Project-specific settings
- Django Matt middleware

Example:
```python
"""
My Project settings.

Generated by Django Matt config management command.
"""

import os
from pathlib import Path

# Import the Django Matt configuration system
from django_matt.config import configure

# Build paths inside the project
BASE_DIR = Path(__file__).resolve().parent.parent

# Determine the environment
ENVIRONMENT = os.environ.get("DJANGO_ENV", "development")

# Configure the application
settings = configure(
    # Specify the environment (development, staging, production)
    environment=ENVIRONMENT,
    
    # Specify the components to load
    components=["database", "cache", "security", "performance"],
    
    # Specify additional settings
    extra_settings={
        # Project-specific settings
        "ROOT_URLCONF": "my_project.urls",
        "WSGI_APPLICATION": "my_project.wsgi.application",
        
        # Add your project's apps
        "INSTALLED_APPS": [
            # Django Matt apps
            "django_matt",
            
            # Your project's apps
            "my_project.core",
        ],
        
        # Add your project's middleware
        "MIDDLEWARE": [
            # Django Matt middleware
            "django_matt.middleware.BenchmarkMiddleware",
        ],
        
        # Add your project's templates
        "TEMPLATES": [
            {
                "DIRS": [
                    os.path.join(BASE_DIR, "my_project", "templates"),
                ],
            },
        ],
        
        # Add your project's static files
        "STATICFILES_DIRS": [
            os.path.join(BASE_DIR, "my_project", "static"),
        ],
        
        # Add your project's media files
        "MEDIA_ROOT": os.path.join(BASE_DIR, "my_project", "media"),
    },
    
    # Apply the settings to Django's settings module
    apply_to_django=True,
)

# You can access the settings directly if needed
DEBUG = settings["DEBUG"]
SECRET_KEY = settings["SECRET_KEY"]

# You can also add additional settings after configuration
SOME_CUSTOM_SETTING = "custom value"

# For demonstration purposes, print the environment
if DEBUG:
    print(f"Running in {ENVIRONMENT} environment")
```

#### Environment Files

The generated `.env` files contain environment variables for different environments. They include:

- Core settings (environment, secret key, allowed hosts)
- Database settings
- Cache settings
- Security settings (for production)
- Django Matt settings
- Email settings (for production)

Example for development:
```
# My Project development environment variables
DJANGO_ENV=development
DJANGO_SECRET_KEY=1234567890abcdef1234567890abcdef1234567890abcdef1234567890abcdef
ALLOWED_HOSTS=localhost,127.0.0.1,[::1]

# Database settings
DB_ENGINE=django.db.backends.sqlite3
DB_NAME=db.sqlite3
DB_USER=
DB_PASSWORD=
DB_HOST=
DB_PORT=

# Cache settings
CACHE_BACKEND=django.core.cache.backends.locmem.LocMemCache
CACHE_LOCATION=django_matt
CACHE_TIMEOUT=300

# Django Matt settings
DJANGO_MATT_BENCHMARK_ENABLED=True
DJANGO_MATT_CACHE_ENABLED=True
DJANGO_MATT_CACHE_TIMEOUT=300
```

Example for production:
```
# My Project production environment variables
DJANGO_ENV=production
DJANGO_SECRET_KEY=1234567890abcdef1234567890abcdef1234567890abcdef1234567890abcdef
ALLOWED_HOSTS=example.com,www.example.com

# Database settings
DB_ENGINE=django.db.backends.postgresql
DB_NAME=my_project
DB_USER=my_project
DB_PASSWORD=change_me
DB_HOST=localhost
DB_PORT=5432

# Cache settings
CACHE_BACKEND=django.core.cache.backends.redis.RedisCache
CACHE_LOCATION=redis://localhost:6379/1
CACHE_TIMEOUT=3600
REDIS_URL=redis://localhost:6379/0

# Security settings
CSRF_COOKIE_SECURE=True
SESSION_COOKIE_SECURE=True
SECURE_SSL_REDIRECT=True
SECURE_HSTS_SECONDS=31536000
SECURE_HSTS_INCLUDE_SUBDOMAINS=True
SECURE_HSTS_PRELOAD=True

# Django Matt settings
DJANGO_MATT_BENCHMARK_ENABLED=False
DJANGO_MATT_CACHE_ENABLED=True
DJANGO_MATT_CACHE_TIMEOUT=3600

# Email settings
EMAIL_HOST=smtp.example.com
EMAIL_PORT=587
EMAIL_HOST_USER=user@example.com
EMAIL_HOST_PASSWORD=change_me
EMAIL_USE_TLS=True
DEFAULT_FROM_EMAIL=noreply@example.com
```

### Best Practices

- Initialize your project with `python manage.py config init` to create the basic configuration files
- Use environment-specific `.env` files for different environments
- Add `.env` to your `.gitignore` file to avoid committing sensitive information
- Use `.env.example` as a template for other developers
- Generate environment-specific settings files for complex projects

## Hot Reloading

The `runserver_hot` command runs the Django development server with hot reloading enabled. It automatically reloads the browser when you make changes to your code.

```bash
python manage.py runserver_hot [addrport]
```

Options:
- `addrport`: Optional port number, or ipaddr:port

Example:
```bash
# Run the server on the default port (8000)
python manage.py runserver_hot

# Run the server on a specific port
python manage.py runserver_hot 8080

# Run the server on a specific IP address and port
python manage.py runserver_hot 0.0.0.0:8000
```

For more information on hot reloading, see the [Hot Reloading documentation](hot_reloading.md). 